<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>时效总览</title>

    <link rel="stylesheet" type="text/css" href="../../dm/common.css">
    <link href="../../tools/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="../../tools/bootstrap/css/buttons.css" rel="stylesheet">
    <link href="../../tools/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../../tools/bootstrap/datatable/jquery.dataTables.min.css" rel="stylesheet">

    <script src="../../tools/jquery/jquery-2.1.3.min.js"></script>
    <script src="../../tools/bootstrap/js/bootstrap.min.js"></script>
    <script src="../../tools/bootstrap/datatable/jquery.dataTables.min.js"></script>
    <script src="../../tools/jquery/ZeroClipboard.js"></script>
    <script src="../../tools/echarts-2.0.4/echarts-plain.js"></script>

    <script src="../../framework/core.js"></script>
    <script src="../../framework/ajax.js"></script>
    <script src="../../dm/common.js"></script>

    <script type="text/javascript">
    var globalValiable = window.parent.globalValiable,
        DayList = [],CenterList = [],CenterPList = [],CompanyList = [],
        TrendSeries = [0,0,0,0,0,0],Frist = false;

    window.onload = function() {
        var originData = globalValiable.data,
            queryParams = globalValiable.queryParams,
            trend = document.getElementById('TrendCanvas'),
            List = document.getElementById("CenterList");
        trend.style.height = (screen.height - 265) + 'px';

        if(queryParams.param3 == undefined){
            List.options.add(new Option('全网','全网'));
        }
        for(var i = 0; i < originData.length; i++){
            var inday = originData[i]["inday"],
                center = originData[i]["send_center"],
                company = originData[i]["send_org"];

            if(!DayList.contains(inday)){
                DayList.push(inday);
            }
            if(!CompanyList.contains(company)){
                CompanyList.push(company);
                List.options.add(new Option(company,company));
            }
            if(!CenterList.contains(center)){
                var temp = {};
                temp.name = center;
                temp.parent = company;
                CenterList.push(center);
                CenterPList.push(temp);
                List.options.add(new Option(center,center));
            }
        }

        SummaryTable();
        DetailTable();
        $("#Tab1").click();
        $("#net").click();
        $("#op").click();  
    } 

    function DetailTable(){
        var originData = globalValiable.data,
            data = [],dataP = [],dataD = [];          

        for(var d in DayList){
            if(d != 'contains'){
                var inday = DayList[d];
                dataP[inday] = [];
                data[inday] = [];

                dataP[inday]['total'] = {n:0,tn:0,nadd:0,tadd:0,cn:0,ctn:0,cnadd:0,ctadd:0,ipn:0,iptn:0,opn:0,optn:0};
                data[inday]['total'] = {nr:'',nra:'',or:'',ora:'',ipr:'',opr:''};

                for(c in CenterList){
                    if(c != 'contains'){
                        var center = CenterList[c];
                        dataP[inday][center] = {n:0,tn:0,nadd:0,tadd:0,cn:0,ctn:0,cnadd:0,ctadd:0,ipn:0,iptn:0,opn:0,optn:0,parent:company};
                        data[inday][center] = {nr:'',nra:'',or:'',ora:'',ipr:'',opr:''};
                    }
                }

                for(p in CompanyList){
                    if(p != 'contains'){
                        var company = CompanyList[p];
                        dataP[inday][company] = {n:0,tn:0,nadd:0,tadd:0,cn:0,ctn:0,cnadd:0,ctadd:0,ipn:0,iptn:0,opn:0,optn:0};
                        data[inday][company] = {nr:'',nra:'',or:'',ora:'',ipr:'',opr:''};
                    }
                }
            }
        }

        for(var i = 0; i < originData.length; i++){
            var inday = originData[i]["inday"],
                center = originData[i]["send_center"],
                company = originData[i]["send_org"];

            if(dataD[center] == null){
                dataD[center] = {n:0,tn:0,nadd:0,tadd:0,cn:0,ctn:0,cnadd:0,ctadd:0,ipn:0,iptn:0,opn:0,optn:0};
            }
            if(dataD[company] == null){
                dataD[company] = {n:0,tn:0,nadd:0,tadd:0,cn:0,ctn:0,cnadd:0,ctadd:0,ipn:0,iptn:0,opn:0,optn:0};
            }
            if(dataD['total'] == null){
                dataD['total'] = {n:0,tn:0,nadd:0,tadd:0,cn:0,ctn:0,cnadd:0,ctadd:0,ipn:0,iptn:0,opn:0,optn:0};
            }

            dataP[inday][center].n += originData[i]["net_n"];
            dataP[inday][center].tn += originData[i]["net_tn"];
            dataP[inday][center].nadd += originData[i]["net_add"];
            dataP[inday][center].tadd += originData[i]["net_tadd"];
            dataP[inday][center].cn += originData[i]["cen_n"];
            dataP[inday][center].ctn += originData[i]["cen_tn"];
            dataP[inday][center].cnadd += originData[i]["cen_add"];
            dataP[inday][center].ctadd += originData[i]["cen_tadd"];
            dataP[inday][center].ipn += originData[i]["ipn"];
            dataP[inday][center].iptn += originData[i]["iptn"];
            dataP[inday][center].opn += originData[i]["opn"];
            dataP[inday][center].optn += originData[i]["optn"];

            dataP[inday][company].n += originData[i]["net_n"];
            dataP[inday][company].tn += originData[i]["net_tn"];
            dataP[inday][company].nadd += originData[i]["net_add"];
            dataP[inday][company].tadd += originData[i]["net_tadd"];
            dataP[inday][company].cn += originData[i]["cen_n"];
            dataP[inday][company].ctn += originData[i]["cen_tn"];
            dataP[inday][company].cnadd += originData[i]["cen_add"];
            dataP[inday][company].ctadd += originData[i]["cen_tadd"];
            dataP[inday][company].ipn += originData[i]["ipn"];
            dataP[inday][company].iptn += originData[i]["iptn"];
            dataP[inday][company].opn += originData[i]["opn"];
            dataP[inday][company].optn += originData[i]["optn"];

            dataP[inday]['total'].n += originData[i]["net_n"];
            dataP[inday]['total'].tn += originData[i]["net_tn"];
            dataP[inday]['total'].nadd += originData[i]["net_add"];
            dataP[inday]['total'].tadd += originData[i]["net_tadd"];
            dataP[inday]['total'].cn += originData[i]["cen_n"];
            dataP[inday]['total'].ctn += originData[i]["cen_tn"];
            dataP[inday]['total'].cnadd += originData[i]["cen_add"];
            dataP[inday]['total'].ctadd += originData[i]["cen_tadd"];
            dataP[inday]['total'].ipn += originData[i]["ipn"];
            dataP[inday]['total'].iptn += originData[i]["iptn"];
            dataP[inday]['total'].opn += originData[i]["opn"];
            dataP[inday]['total'].optn += originData[i]["optn"];

            dataD[center].n += originData[i]["net_n"];
            dataD[center].tn += originData[i]["net_tn"];
            dataD[center].nadd += originData[i]["net_add"];
            dataD[center].tadd += originData[i]["net_tadd"];
            dataD[center].cn += originData[i]["cen_n"];
            dataD[center].ctn += originData[i]["cen_tn"];
            dataD[center].cnadd += originData[i]["cen_add"];
            dataD[center].ctadd += originData[i]["cen_tadd"];
            dataD[center].ipn += originData[i]["ipn"];
            dataD[center].iptn += originData[i]["iptn"];
            dataD[center].opn += originData[i]["opn"];
            dataD[center].optn += originData[i]["optn"];

            dataD[company].n += originData[i]["net_n"];
            dataD[company].tn += originData[i]["net_tn"];
            dataD[company].nadd += originData[i]["net_add"];
            dataD[company].tadd += originData[i]["net_tadd"];
            dataD[company].cn += originData[i]["cen_n"];
            dataD[company].ctn += originData[i]["cen_tn"];
            dataD[company].cnadd += originData[i]["cen_add"];
            dataD[company].ctadd += originData[i]["cen_tadd"];
            dataD[company].ipn += originData[i]["ipn"];
            dataD[company].iptn += originData[i]["iptn"];
            dataD[company].opn += originData[i]["opn"];
            dataD[company].optn += originData[i]["optn"];

            dataD['total'].n += originData[i]["net_n"];
            dataD['total'].tn += originData[i]["net_tn"];
            dataD['total'].nadd += originData[i]["net_add"];
            dataD['total'].tadd += originData[i]["net_tadd"];
            dataD['total'].cn += originData[i]["cen_n"];
            dataD['total'].ctn += originData[i]["cen_tn"];
            dataD['total'].cnadd += originData[i]["cen_add"];
            dataD['total'].ctadd += originData[i]["cen_tadd"];
            dataD['total'].ipn += originData[i]["ipn"];
            dataD['total'].iptn += originData[i]["iptn"];
            dataD['total'].opn += originData[i]["opn"];
            dataD['total'].optn += originData[i]["optn"];
        }

        for(var d in DayList){
            for(var c in CenterList){
                if((c != 'contains')&&(d != 'contains')){
                    var temp = dataP[DayList[d]][CenterList[c]];
                    data[DayList[d]][CenterList[c]].nr = Rate(temp.n,temp.tn);
                    data[DayList[d]][CenterList[c]].nra = Rate(temp.nadd,temp.tadd);
                    data[DayList[d]][CenterList[c]].or = Rate(temp.cn,temp.ctn);
                    data[DayList[d]][CenterList[c]].ora = Rate(temp.cnadd,temp.ctadd);
                    data[DayList[d]][CenterList[c]].ipr = Rate(temp.ipn,temp.iptn);
                    data[DayList[d]][CenterList[c]].opr = Rate(temp.opn,temp.optn);
                    data[DayList[d]][CenterList[c]].parent = temp.parent;
                }
            }

            for(var c in CompanyList){
                if((c != 'contains')&&(d != 'contains')){
                    var temp = dataP[DayList[d]][CompanyList[c]];
                    data[DayList[d]][CompanyList[c]].nr = Rate(temp.n,temp.tn);
                    data[DayList[d]][CompanyList[c]].nra = Rate(temp.nadd,temp.tadd);
                    data[DayList[d]][CompanyList[c]].or = Rate(temp.cn,temp.ctn);
                    data[DayList[d]][CompanyList[c]].ora = Rate(temp.cnadd,temp.ctadd);
                    data[DayList[d]][CompanyList[c]].ipr = Rate(temp.ipn,temp.iptn);
                    data[DayList[d]][CompanyList[c]].opr = Rate(temp.opn,temp.optn);
                }
            }

            if(d != 'contains'){
                var temp = dataP[DayList[d]]['total'];
                data[DayList[d]]['total'].nr = Rate(temp.n,temp.tn);
                data[DayList[d]]['total'].nra = Rate(temp.nadd,temp.tadd);
                data[DayList[d]]['total'].or = Rate(temp.cn,temp.ctn);
                data[DayList[d]]['total'].ora = Rate(temp.cnadd,temp.ctadd);
                data[DayList[d]]['total'].ipr = Rate(temp.ipn,temp.iptn);
                data[DayList[d]]['total'].opr = Rate(temp.opn,temp.optn);
            }
        }

        WeMadeTable('Table1','nr','n','tn',data,dataD);
        WeMadeTable('Table2','nra','nadd','tadd',data,dataD);
        WeMadeTable('Table3','or','cn','ctn',data,dataD);
        WeMadeTable('Table4','ora','cnadd','ctadd',data,dataD);
        WeMadeTable('Table5','ipr','ipn','iptn',data,dataD);
        WeMadeTable('Table6','opr','opn','optn',data,dataD);
    }

    function WeMadeTable(MyTable,index,n,tn,data,dataD){
        var queryParams = globalValiable.queryParams,
            table = document.getElementById(MyTable)
            count = 1;

//////////////////////////////////添加表头
        var h = table.createTHead().insertRow();
        var td = h.insertCell(0);  
        td.innerText = '序列';
        td.style.textAlign = 'left';
        td.style.color = '#999';
        var td = h.insertCell(1);  
        td.innerText = '名称';
        td.style.textAlign = 'left';
        td.style.color = '#999';
        for(var i = 0; i < DayList.length; i++){
            var td = h.insertCell(i + 2);  
            td.innerText = DayList[i].substr(DayList[i].indexOf('/') + 1);
            td.style.textAlign = 'right';
            td.style.color = '#999';
        }
        var td = h.insertCell(DayList.length + 2);  
        td.innerText = '累计';
        td.style.textAlign = 'right';
        td.style.color = '#999';
/////////////////////////////////////创建表格
        var tbody = table.appendChild(document.createElement("tbody"));
        var tr = tbody.appendChild(document.createElement("tr"));
        if(queryParams.param3 == undefined){
            var td = tr.insertCell(0); 
            td.innerText = count++;
            td.style.textAlign = 'left';
            td.style.color = '#337AB7';
            var td = tr.insertCell(1); 
            td.innerText = '全网';
            td.style.textAlign = 'left';
            td.style.color = '#337AB7';
            for(var i = 0; i < DayList.length; i++){
                var td = tr.insertCell(i + 2);
                td.innerText = data[DayList[i]]['total'][index];
                td.style.textAlign = 'right';
                td.style.color = '#337AB7';
            }
            var td = tr.insertCell(DayList.length + 2);
            td.innerText = Rate(dataD['total'][n],dataD['total'][tn]);
            td.style.textAlign = 'right';
            td.style.color = '#337AB7';
        }

        for(p in CompanyList){
            if(p != 'contains'){
                var tr = tbody.appendChild(document.createElement("tr"));
                var td = tr.insertCell(0); 
                td.innerText = count++;
                td.style.textAlign = 'left';
                td.style.color = '#337AB7';
                var td = tr.insertCell(1); 
                td.innerText = CompanyList[p];
                td.style.textAlign = 'left';
                td.style.color = '#337AB7';
                for(var i = 0; i < DayList.length; i++){
                    var td = tr.insertCell(i + 2);
                    td.innerText = data[DayList[i]][CompanyList[p]][index];
                    td.style.textAlign = 'right';
                    td.style.color = '#337AB7';
                }
                var td = tr.insertCell(DayList.length + 2);
                td.innerText = Rate(dataD[CompanyList[p]][n],dataD[CompanyList[p]][tn]);
                td.style.textAlign = 'right';
                td.style.color = '#337AB7';

                for(c in CenterList){
                    if((c != 'contains')&&(data[DayList[0]][CenterList[c]].parent == CompanyList[p])){
                        var tr = tbody.appendChild(document.createElement("tr"));
                        var td = tr.insertCell(0); 
                        td.innerText = count++;
                        td.style.textAlign = 'left';
                        var td = tr.insertCell(1); 
                        td.innerText = CenterList[c];
                        td.style.textAlign = 'left';
                        for(var i = 0; i < DayList.length; i++){
                            var td = tr.insertCell(i + 2);
                            td.innerText = data[DayList[i]][CenterList[c]][index];
                            td.style.textAlign = 'right';
                        }
                        var td = tr.insertCell(DayList.length + 2);
                        td.innerText = Rate(dataD[CenterList[c]][n],dataD[CenterList[c]][tn]);
                        td.style.textAlign = 'right';
                    }
                }
            }
        }

        $('#' + MyTable).dataTable({
            "bPaginate": false,
            "sProcessing": "正在加载中......", 
            "oPaginate": false, 
            "sInfoFiltered":false,
            "sInfo":false,
            "bLengthChange":false,
            "sZeroRecords": "没有符合相关条件的数据TAT",                     
            "sEmptyTable": "表中无数据存在0_o", 
        });
    }

    function SummaryTable(){
        var originData = globalValiable.data,
            queryParams = globalValiable.queryParams,
            nav = document.getElementById("NavSummary"),
            table = document.getElementById("SummaryTable"),
            dataC = [],dataP = [],count = 1,
            dataA = {n:0,tn:0,nadd:0,tadd:0,cn:0,ctn:0,cnadd:0,ctadd:0,ipn:0,iptn:0,opn:0,optn:0};

        for(var i = 0; i < originData.length; i++){
            var center = originData[i]["send_center"],
                company = originData[i]["send_org"];

            if(dataP[company] == null){
                dataP[company] = {n:0,tn:0,nadd:0,tadd:0,cn:0,ctn:0,cnadd:0,ctadd:0,ipn:0,iptn:0,opn:0,optn:0};
            }
            if(dataC[center] == null){
                dataC[center] = {n:0,tn:0,nadd:0,tadd:0,cn:0,ctn:0,cnadd:0,ctadd:0,ipn:0,iptn:0,opn:0,optn:0,parent:company};
            }

            dataC[center].n += originData[i]["net_n"];
            dataC[center].tn += originData[i]["net_tn"];
            dataC[center].nadd += originData[i]["net_add"];
            dataC[center].tadd += originData[i]["net_tadd"];
            dataC[center].cn += originData[i]["cen_n"];
            dataC[center].ctn += originData[i]["cen_tn"];
            dataC[center].cnadd += originData[i]["cen_add"];
            dataC[center].ctadd += originData[i]["cen_tadd"];
            dataC[center].ipn += originData[i]["ipn"];
            dataC[center].iptn += originData[i]["iptn"];
            dataC[center].opn += originData[i]["opn"];
            dataC[center].optn += originData[i]["optn"];

            dataP[company].n += originData[i]["net_n"];
            dataP[company].tn += originData[i]["net_tn"];
            dataP[company].nadd += originData[i]["net_add"];
            dataP[company].tadd += originData[i]["net_tadd"];
            dataP[company].cn += originData[i]["cen_n"];
            dataP[company].ctn += originData[i]["cen_tn"];
            dataP[company].cnadd += originData[i]["cen_add"];
            dataP[company].ctadd += originData[i]["cen_tadd"];
            dataP[company].ipn += originData[i]["ipn"];
            dataP[company].iptn += originData[i]["iptn"];
            dataP[company].opn += originData[i]["opn"];
            dataP[company].optn += originData[i]["optn"];

            dataA.n += originData[i]["net_n"];
            dataA.tn += originData[i]["net_tn"];
            dataA.nadd += originData[i]["net_add"];
            dataA.tadd += originData[i]["net_tadd"];
            dataA.cn += originData[i]["cen_n"];
            dataA.ctn += originData[i]["cen_tn"];
            dataA.cnadd += originData[i]["cen_add"];
            dataA.ctadd += originData[i]["cen_tadd"];
            dataA.ipn += originData[i]["ipn"];
            dataA.iptn += originData[i]["iptn"];
            dataA.opn += originData[i]["opn"];
            dataA.optn += originData[i]["optn"];
        }
/////////////////////////////////////创建表头
        var h = table.createTHead().insertRow();
        var td = h.insertCell(0);  
        td.innerText = '序列';
        td.style.textAlign = 'left';
        td.style.color = '#999';
        var td = h.insertCell(1);  
        td.innerText = '名称';
        td.style.textAlign = 'left';
        td.style.color = '#999';
        var td = h.insertCell(2);  
        td.innerText = '客户时效达成率';
        td.style.textAlign = 'right';
        td.style.color = '#999';
        var td = h.insertCell(3);  
        td.innerText = '客户加一达成率';
        td.style.textAlign = 'right';
        td.style.color = '#999';
        var td = h.insertCell(4);  
        td.innerText = '运营时效达成率';
        td.style.textAlign = 'right';
        td.style.color = '#999';
        var td = h.insertCell(5);  
        td.innerText = '运营加一达成率';
        td.style.textAlign = 'right';
        td.style.color = '#999';
        var td = h.insertCell(6);  
        td.innerText = '交件准点率';
        td.style.textAlign = 'right';
        td.style.color = '#999';
        var td = h.insertCell(7);  
        td.innerText = '接件准点率';
        td.style.textAlign = 'right';
        td.style.color = '#999';
////////////////////////////////////////创建表格
        var tbody = table.appendChild(document.createElement("tbody"));
        if(queryParams.param3 == undefined){
            var tr = tbody.appendChild(document.createElement("tr"));
            var td = tr.insertCell(0); 
            td.innerText = count++;
            td.style.textAlign = 'left';
            var td = tr.insertCell(1); 
            td.innerText = '全网';
            td.style.textAlign = 'left';
            td.style.color = '#337AB7';
            var td = tr.insertCell(2);
            td.innerText = Rate(dataA.n,dataA.tn);
            td.style.textAlign = 'right';
            td.style.color = '#337AB7';
            var td = tr.insertCell(3);
            td.innerText = Rate(dataA.nadd,dataA.tadd);
            td.style.textAlign = 'right';
            td.style.color = '#337AB7';
            var td = tr.insertCell(4);
            td.innerText = Rate(dataA.cn,dataA.ctn);
            td.style.textAlign = 'right';
            td.style.color = '#337AB7';
            var td = tr.insertCell(5);
            td.innerText = Rate(dataA.cnadd,dataA.ctadd);
            td.style.textAlign = 'right';
            td.style.color = '#337AB7';
            var td = tr.insertCell(6);
            td.innerText = Rate(dataA.ipn,dataA.iptn);
            td.style.textAlign = 'right';
            td.style.color = '#337AB7';
            var td = tr.insertCell(7);
            td.innerText = Rate(dataA.opn,dataA.optn);
            td.style.textAlign = 'right';
            td.style.color = '#337AB7';
        }

        for(var p in CompanyList){
            if(p != 'contains'){
                var temp = CompanyList[p],
                    tr = tbody.appendChild(document.createElement("tr"));
                var td = tr.insertCell(0); 
                td.innerText = count++;
                td.style.textAlign = 'left';
                td.style.color = '#337AB7';
                var td = tr.insertCell(1); 
                td.innerText = temp;
                td.style.textAlign = 'left';
                td.style.color = '#337AB7';
                var td = tr.insertCell(2);
                td.innerText = Rate(dataP[temp].n,dataP[temp].tn);
                td.style.textAlign = 'right';
                td.style.color = '#337AB7';
                var td = tr.insertCell(3);
                td.innerText = Rate(dataP[temp].nadd,dataP[temp].tadd);
                td.style.textAlign = 'right';
                td.style.color = '#337AB7';
                var td = tr.insertCell(4);
                td.innerText = Rate(dataP[temp].cn,dataP[temp].ctn);
                td.style.textAlign = 'right';
                td.style.color = '#337AB7';
                var td = tr.insertCell(5);
                td.innerText = Rate(dataP[temp].cnadd,dataP[temp].ctadd);
                td.style.textAlign = 'right';
                td.style.color = '#337AB7';
                var td = tr.insertCell(6);
                td.innerText = Rate(dataP[temp].ipn,dataP[temp].iptn);
                td.style.textAlign = 'right';
                td.style.color = '#337AB7';
                var td = tr.insertCell(7);
                td.innerText = Rate(dataP[temp].opn,dataP[temp].optn);
                td.style.textAlign = 'right';
                td.style.color = '#337AB7';

                for(var c in CenterList){
                    if((c != 'contains')&&(dataC[CenterList[c]].parent == temp)){
                        var t = CenterList[c],
                            tr = tbody.appendChild(document.createElement("tr"));
                        var td = tr.insertCell(0); 
                        td.innerText = count++;
                        td.style.textAlign = 'left';
                        var td = tr.insertCell(1); 
                        td.innerText = t;
                        td.style.textAlign = 'left';
                        var td = tr.insertCell(2);
                        td.innerText = Rate(dataC[t].n,dataC[t].tn);
                        td.style.textAlign = 'right';
                        var td = tr.insertCell(3);
                        td.innerText = Rate(dataC[t].nadd,dataC[t].tadd);
                        td.style.textAlign = 'right';
                        var td = tr.insertCell(4);
                        td.innerText = Rate(dataC[t].cn,dataC[t].ctn);
                        td.style.textAlign = 'right';
                        var td = tr.insertCell(5);
                        td.innerText = Rate(dataC[t].cnadd,dataC[t].ctadd);
                        td.style.textAlign = 'right';
                        var td = tr.insertCell(6);
                        td.innerText = Rate(dataC[t].ipn,dataC[t].iptn);
                        td.style.textAlign = 'right';
                        var td = tr.insertCell(7);
                        td.innerText = Rate(dataC[t].opn,dataC[t].optn);
                        td.style.textAlign = 'right';
                    }
                }
            }
        }

        $('#SummaryTable').dataTable({
            "bPaginate": false,
            "sProcessing": "正在加载中......", 
            "oPaginate": false, 
            "sInfoFiltered":false,
            "sInfo":false,
            "bLengthChange":false,
            "sZeroRecords": "没有符合相关条件的数据TAT",                     
            "sEmptyTable": "表中无数据存在0_o", 
        });
    }

    function Trend(){
        var originData = globalValiable.data,
            Selected = document.getElementById("CenterList").value,
            data = [[],[],[],[],[],[]],
            SeriesName = ['客户时效','客户加一','运营时效','运营加一','交件准点','接件准点'],
            LineType = ['solid','dashed','solid','dashed','dotted','dotted'],
            LineColor = ['#337AB7','#337AB7','#008972','#008972','#F2572D','#A488A5'],
            datap = [],series = [],datalegend = [],
            min = 100,max = 0;

        for(var i = 0; i < originData.length; i++){
            var inday = originData[i]["inday"],
                center = originData[i]["send_center"],
                company = originData[i]["send_org"];

            if((Selected == '全网')||(Selected == center)||(Selected == company)){
                if(datap[inday] == null){
                    datap[inday] = {};
                    datap[inday].n = originData[i]["net_n"];
                    datap[inday].tn = originData[i]["net_tn"];
                    datap[inday].nadd = originData[i]["net_add"];
                    datap[inday].tadd = originData[i]["net_tadd"];
                    datap[inday].cn = originData[i]["cen_n"];
                    datap[inday].ctn = originData[i]["cen_tn"];
                    datap[inday].cnadd = originData[i]["cen_add"];
                    datap[inday].ctadd = originData[i]["cen_tadd"];
                    datap[inday].ipn = originData[i]["ipn"];
                    datap[inday].iptn = originData[i]["iptn"];
                    datap[inday].opn = originData[i]["opn"];
                    datap[inday].optn = originData[i]["optn"];
                }
                else{
                    datap[inday].n += originData[i]["net_n"];
                    datap[inday].tn += originData[i]["net_tn"];
                    datap[inday].nadd += originData[i]["net_add"];
                    datap[inday].tadd += originData[i]["net_tadd"];
                    datap[inday].cn += originData[i]["cen_n"];
                    datap[inday].ctn += originData[i]["cen_tn"];
                    datap[inday].cnadd += originData[i]["cen_add"];
                    datap[inday].ctadd += originData[i]["cen_tadd"];
                    datap[inday].ipn += originData[i]["ipn"];
                    datap[inday].iptn += originData[i]["iptn"];
                    datap[inday].opn += originData[i]["opn"];
                    datap[inday].optn += originData[i]["optn"];
                }
            }
        }

        for(var d in DayList){
            if(d != 'contains'){
                if(TrendSeries[0]){
                    if(datap[DayList[d]].tn == null){
                        data[0].push(datap[DayList[d]].tn);
                    }
                    else{
                        var r = Math.round(datap[DayList[d]].n/datap[DayList[d]].tn*1000)/10;
                        data[0].push(r);
                        if(r < min){min = r;}
                        if(r > max){max = r;}
                    }
                }
                if(TrendSeries[1]){
                    if(datap[DayList[d]].tadd == null){
                        data[1].push(datap[DayList[d]].tadd);
                    }
                    else{
                        var r = Math.round(datap[DayList[d]].nadd/datap[DayList[d]].tadd*1000)/10;
                        data[1].push(r);
                        if(r < min){min = r;}
                        if(r > max){max = r;}
                    }
                }
                if(TrendSeries[2]){
                    if(datap[DayList[d]].tn == null){
                        data[2].push(datap[DayList[d]].ctn);
                    }
                    else{
                        var r = Math.round(datap[DayList[d]].cn/datap[DayList[d]].ctn*1000)/10;
                        data[2].push(r);
                        if(r < min){min = r;}
                        if(r > max){max = r;}
                    }
                }
                if(TrendSeries[3]){
                    if(datap[DayList[d]].tn == null){
                        data[3].push(datap[DayList[d]].ctadd);
                    }
                    else{
                        var r = Math.round(datap[DayList[d]].cnadd/datap[DayList[d]].ctadd*1000)/10;
                        data[3].push(r);
                        if(r < min){min = r;}
                        if(r > max){max = r;}
                    }
                }
                if(TrendSeries[4]){
                    if(datap[DayList[d]].tn == null){
                        data[4].push(datap[DayList[d]].iptn);
                    }
                    else{
                        var r = Math.round(datap[DayList[d]].ipn/datap[DayList[d]].iptn*1000)/10;
                        data[4].push(r);
                        if(r < min){min = r;}
                        if(r > max){max = r;}
                    }
                }
                if(TrendSeries[5]){
                    if(datap[DayList[d]].tn == null){
                        data[5].push(datap[DayList[d]].optn);
                    }
                    else{
                        var r = Math.round(datap[DayList[d]].opn/datap[DayList[d]].optn*1000)/10;
                        data[5].push(r);
                        if(r < min){min = r;}
                        if(r > max){max = r;}
                    }
                }
            }
        }

        for(var i = 0; i < 6; i++){
            if(TrendSeries[i]){
                datalegend.push({name:SeriesName[i], textStyle:{normal:{color:'#999'}}});

                series.push({
                    name:SeriesName[i],
                    type:'line',
                    data:data[i],
                    symbol:'none',
                    itemStyle: {
                        normal: {
                            color:LineColor[i],
                            lineStyle: {   
                                type:LineType[i],
                                color:LineColor[i],
                                width: 3
                            }
                        }
                    }
                });
            }
        }

        min = Math.floor(min/10)*10;
        max = Math.ceil(max/10)*10;

        var myChart = echarts.init(document.getElementById('TrendCanvas'));
//////////////////////////////////////////////OPTION
var option = {
    legend: {
        x:'right',
        y:'20px',
        selectedMode:false,
        data:datalegend,
        textStyle:{
            fontFamily:'Microsoft YaHei',
            fontSize:'18',
            color:'#999',
        }
    },
    tooltip : {
        trigger: 'axis',
        axisPointer:{type : 'none'},
        textStyle:{fontSize:'16',color:'#fff',fontFamily:'Microsoft YaHei'},
        formatter:function(d){
            var l = d.length,
                result = d[0][1];

            for(var i = 0;i < d.length;i++){
                if(d[i][2] != '-'){
                    result += '<br/>' + d[i][0] + ':' + d[i][2] + '%';
                }
                else{
                    result += '<br/>' + d[i][0] + ':' + '-';
                }
            }

            return result;
        }
    },
    calculable : true,
    xAxis : [
        {
            type : 'category',
            axisLine:{lineStyle:{color:'#999'}},
            boundaryGap : false,
            axisLabel:{
                rotate:-30,
                interval:0,
                textStyle:{color:'#999',fontSize:'16'}
            },
            data : DayList
        }
    ],
    yAxis : [
        {
            name:'百分比',
            nameTextStyle:{
                fontSize:'18',
                fontFamily:'Microsoft YaHei'
            },
            type : 'value',
            axisLine:{lineStyle:{color:'#999'}},
            axisLabel:{textStyle:{color:'#999',fontSize:'16'}},
            min:min,
            max:max
        }
    ],
    series : series
};            
       myChart.setOption(option);
    }

    function styler(value,row,index){
        if(value>=0.7){
            return 'color:#389562;font-weight:bold;';
        }
        else if(value<0.4){
            return 'color:#C70B25;font-weight:bold;';
        }
        else{
            return 'color:#F28705;font-weight:bold;';
        }
    }

    function formatter(value, row, index){
        return formatMoney(value, 1);
    }

    function formatMoney(s, n) {   
       n = n > 0 && n <= 20 ? n : 2;   
       s = parseFloat((s + "").replace(/[^\d\.-]/g, "")).toFixed(n) + "";   
       var l = s.split(".")[0].split("").reverse(),   
       r = s.split(".")[1];   
       t = "";   
       for(i = 0; i < l.length; i ++ ) {   
          t += l[i] + ((i + 1) % 3 == 0 && (i + 1) != l.length ? "," : "");   
       }   
       return t.split("").reverse().join("") + "." + r;   
    } 

    function Rate(n,tn){
        if((tn != null)||(tn == 0)){
            return Math.round(n/tn*1000)/10 + '%';
        }
        else{
            return '';
        }
    }

    function Repainting(v){
        TrendSeries[v] = Math.abs(TrendSeries[v] - 1);
        if(Frist){
            Trend();
        }
        else{
            Frist = true;
        }
    }

    Array.prototype.contains = function(obj) {  
        var i = this.length;  
        while (i--) {  
            if (this[i] === obj) {  
                return true;  
            }  
        }  
        return false;  
    }  
    </script>

    <style type="text/css">
        img {max-height: 100%;}
        dt {font-family:Microsoft YaHei;font-size:20px;}
        dd {font-family:Microsoft YaHei;font-size:16px;text-indent:30px}
        li {font-family:Microsoft YaHei;}
        th {
            color:#999;
            font-family:Microsoft YaHei;
            font-style:normal;
        }
        td{font-family:Microsoft YaHei;}
        span {width:16px;height:16px;}
        .panel-heading {font-family:Microsoft YaHei;}
        .table-hover{margin-top: 15px;}
        .btn {font-family:Microsoft YaHei;}
        .copybtn {
            font-family:Microsoft YaHei;
            width:140px;
            margin-top: 3px;
        }
        .Tab {font-family:Microsoft YaHei;}
        #CenterList {
            font-family:Microsoft YaHei;
            font-size:18px;
            float:right;
            padding:8px;
            color:#999;
            border-color:#fff;
            text-align:right;
        }
        .navcustom{
            font-family:Microsoft YaHei;
            text-align: center;
            color:#337AB7;
            width: 140px;
            margin-top: 5px;
            margin-left: 15px;
            border-radius: 4px;
            border: 1px solid #ddd;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.067);
        }
/*//////////////////////////////////////Bootstrap Style*/
        .navcustom li{
            margin: 0;
            border-top: 1px solid #ddd;
        }
        .navcustom li:first-child{
            border-top: none;
        }
        .navcustom li a{
            margin: 0;
            padding: 8px 16px;
            border-radius: 0;
        }
        .navcustom li.active a, ul.nav-tabs li.active a:hover{
            color: #fff;
            background: #0088cc;
            border: 1px solid #0088cc;
        }
        .navcustom li:first-child a{
            border-radius: 4px 4px 0 0;
        }
        .navcustom li:last-child a{
            border-radius: 0 0 4px 4px;
        }
        .navcustom.affix{
            top: 30px; /* Set the top position of pinned element */
        }
    </style>
</head>

<body>
<ul id="myTab" class="nav nav-tabs">
    <li class="Tab"><a id='Tab1' href="#TabCanvas" data-toggle="tab">走势图</a></li>
    <li class="Tab"><a href="#TabSummary" data-toggle="tab">汇总表</a></li>
    <li class="Tab"><a href="#TabDetail" data-toggle="tab">明细表</a></li>
    <li class="Tab"><a href="#TabNotice" data-toggle="tab">说明书</a></li>
</ul>

<div id="myTabContent" class="tab-content">
    <div class="tab-pane fade in active" id="TabCanvas">
        <div class="btn-group" data-toggle="buttons" style="padding:5px;">
            <label class="btn btn-primary" id='net' onclick=Repainting(0)>客户时效</label>
            <label class="btn btn-primary" onclick=Repainting(1)>客户加一</label>
            <label class="btn btn-primary" id='op' onclick=Repainting(2)>运营时效</label>
            <label class="btn btn-primary" onclick=Repainting(3)>运营加一</label>
            <label class="btn btn-primary" onclick=Repainting(4)>交件准点</label>
            <label class="btn btn-primary" onclick=Repainting(5)>接件准点</label>
        </div> 
        <select id="CenterList" onchange="Trend()">
        </select>&nbsp;
        <div id='TrendCanvas' style="height:640px;"></div>
    </div>
    <div class="tab-pane fade" id="TabSummary">
        <table id='SummaryTable' class="display" cellspacing="0" width="100%">
        </table>
    </div>
    <div class="tab-pane fade" id="TabDetail">
        <ul class="nav nav-pills nav-stacked">
           <li class="active" style="margin-top:5px;"><a data-toggle="collapse" data-target="#collapse1">客户时效达成率</a></li>
            <div id="collapse1" class="collapse out">
                <div class="panel-body">
                    <table id='Table1' class="display" cellspacing="0" width="100%">
                    </table>
                </div>
            </div>
           <li class="active" style="margin-top:5px;"><a data-toggle="collapse" data-target="#collapse2">客户时效加一达成率</a></li>
           <div id="collapse2" class="collapse out">
                <div class="panel-body">
                    <table id='Table2' class="display" cellspacing="0" width="100%">
                    </table>
                </div>
            </div>
           <li class="active" style="margin-top:5px;"><a data-toggle="collapse" data-target="#collapse3">运营时效达成率</a></li>
           <div id="collapse3" class="collapse out">
                <div class="panel-body">
                    <table id='Table3' class="display" cellspacing="0" width="100%">
                    </table>
                </div>
            </div>
           <li class="active" style="margin-top:5px;"><a data-toggle="collapse" data-target="#collapse4">运营时效加一达成率</a></li>
           <div id="collapse4" class="collapse out">
                <div class="panel-body">
                    <table id='Table4' class="display" cellspacing="0" width="100%">
                    </table>
                </div>
            </div>
           <li class="active" style="margin-top:5px;"><a data-toggle="collapse" data-target="#collapse5">交件准点率</a></li>
           <div id="collapse5" class="collapse out">
                <div class="panel-body">
                    <table id='Table5' class="display" cellspacing="0" width="100%">
                    </table>
                </div>
            </div>
           <li class="active" style="margin-top:5px;"><a data-toggle="collapse" data-target="#collapse6">接件准点率</a></li>
           <div id="collapse6" class="collapse out">
                <div class="panel-body">
                    <table id='Table6' class="display" cellspacing="0" width="100%">
                    </table>
                </div>
            </div>
        </ul>
    </div>
    <div class="tab-pane fade" id="TabNotice">
        <div id="myCarousel" class="carousel slide">
           <!-- 轮播（Carousel）指标 -->
           <ol class="carousel-indicators">
              <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
              <li data-target="#myCarousel" data-slide-to="1"></li>
              <li data-target="#myCarousel" data-slide-to="2"></li>
           </ol>   
           <!-- 轮播（Carousel）项目 -->
           <div class="carousel-inner">
              <div class="item active">
                 <img src="zk_image/net_aging.png" alt="First slide">
              </div>
              <div class="item">
                 <img src="zk_image/OP_aging.png" alt="Second slide">
              </div>
              <div class="item">
                 <img src="zk_image/shuttle_ontime.png" alt="Third slide">
              </div>
           </div>
           <!-- 轮播（Carousel）导航 -->
           <a class="carousel-control left" href="#myCarousel" 
              data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span></a>
           <a class="carousel-control right" href="#myCarousel" 
              data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span></a>
            </a>
        </div>
    </div>
</div>
</body>
</html>